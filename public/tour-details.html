<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#1a5490">

  <!-- Preconnect to Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- Preload Critical Fonts -->
  <link rel="preload" href="https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrJJfecg.woff2" as="font" type="font/woff2" crossorigin>

  <!-- SEO Meta Tags -->
  <title>Samarkand City Tour: Registan Square | Jahongir Travel</title>
  <meta name="description" content="Explore Samarkand's UNESCO World Heritage sites on a 4-hour private tour. Visit Registan Square, Shah-i-Zinda, and Bibi-Khanym Mosque with an expert local guide.">
  <link rel="canonical" href="https://jahongirtravel.com/tours/samarkand-city-tour">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large">

  <!-- Hreflang Alternates -->
  <link rel="alternate" hreflang="en" href="https://jahongirtravel.com/tours/samarkand-city-tour">
  <link rel="alternate" hreflang="ru" href="https://jahongirtravel.com/ru/tours/samarkand-city-tour">
  <link rel="alternate" hreflang="fr" href="https://jahongirtravel.com/fr/tours/samarkand-city-tour">
  <link rel="alternate" hreflang="x-default" href="https://jahongirtravel.com/tours/samarkand-city-tour">

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="Jahongir Travel">
  <meta property="og:locale" content="en_US">
  <meta property="og:title" content="Samarkand City Tour: Registan Square | Jahongir Travel">
  <meta property="og:description" content="Explore Samarkand's UNESCO World Heritage sites on a 4-hour private tour.">
  <meta property="og:image" content="https://jahongirtravel.com/images/tours/samarkand/hero-main.webp">
  <meta property="og:url" content="https://jahongirtravel.com/tours/samarkand-city-tour">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Samarkand City Tour: Registan Square | Jahongir Travel">
  <meta name="twitter:description" content="Explore Samarkand's UNESCO World Heritage sites on a 4-hour private tour.">
  <meta name="twitter:image" content="https://jahongirtravel.com/images/tours/samarkand/hero-main.webp">

  <!-- Google Fonts: Poppins, Inter & Playfair Display -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Inter:wght@400;500&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">

  <!-- Critical CSS - Inlined for Performance -->
  <style>
    /* Reset & Base */
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    html{font-size:16px;-webkit-text-size-adjust:100%}
    body{font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;line-height:1.6;color:#1E1E1E;background:#FAF8F4;margin:0;-webkit-font-smoothing:antialiased}
    img{display:block;max-width:100%;height:auto}
    h1,h2,h3,h4,h5,h6{font-weight:600;line-height:1.3;margin-top:0;margin-bottom:0.5rem}
    h1{font-size:clamp(1.75rem,4vw,2.5rem)}
    h2{font-size:clamp(1.5rem,3vw,2rem)}
    p{margin-bottom:1rem}
    a{color:#0D4C92;text-decoration:none}
    a:hover{text-decoration:underline}

    /* Utilities */
    .is-hidden{display:none!important}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    /* Skip Link */
    .skip-link{position:absolute;top:-40px;left:0;background:#0D4C92;color:#fff;padding:8px 16px;text-decoration:none;z-index:100;transition:top 0.2s}
    .skip-link:focus{top:0}

    /* SVG Icons */
    .icon{display:inline-block;vertical-align:middle;fill:currentColor;flex-shrink:0}
    .icon--star{color:#F4B400}

    /* Container */
    .container{max-width:1200px;margin:0 auto;padding:0 1.5rem}

    /* Buttons (minimal) */
    .btn{display:inline-flex;align-items:center;gap:8px;padding:12px 24px;border:none;border-radius:6px;font-size:1rem;font-weight:500;cursor:pointer;transition:all 0.2s;min-height:44px;justify-content:center}
    .btn--primary{background:#0D4C92;color:#fff}
    .btn--accent{background:#F4B400;color:#1E1E1E}

    /* Skeleton Loaders */
    .skeleton{background:linear-gradient(90deg,#E3E3E3 0%,#F5F5F5 50%,#E3E3E3 100%);background-size:200% 100%;animation:skeleton-loading 1.5s ease-in-out infinite;border-radius:4px}
    @keyframes skeleton-loading{0%{background-position:200% 0}100%{background-position:-200% 0}}
    .skeleton--hero{height:400px;width:100%;border-radius:8px}
    .skeleton--title{height:32px;width:70%;margin-bottom:16px}
    .skeleton--text{height:16px;width:100%;margin-bottom:8px}
    .skeleton--thumb{height:80px;width:100%;border-radius:4px}

    /* Basic Layout - Prevent FOUC */
    .site-header{background:#fff;position:sticky;top:0;z-index:50}
    .tour-hero{margin:2rem 0}
    .breadcrumbs{padding:1rem 0;font-size:0.875rem}

    /* Form Elements */
    input,select,textarea{font-family:inherit;font-size:1rem;padding:10px 12px;border:1px solid #E3E3E3;border-radius:4px;min-height:44px;width:100%}
    input:focus,select:focus,textarea:focus{outline:2px solid #0D4C92;outline-offset:2px}

    /* Accessibility - Focus visible */
    *:focus-visible{outline:2px solid #0D4C92;outline-offset:2px}

    /* Navigation - Critical (matching index.html .nav--sticky styles) */
    .nav{position:relative;background:rgba(255,255,255,0.95);backdrop-filter:blur(10px);box-shadow:0 2px 8px rgba(0,0,0,0.05)}
    .nav .container{display:flex;align-items:center;justify-content:space-between;gap:32px;padding:16px 24px}
    .nav__logo{text-decoration:none}
    .nav__logo-text{font-family:"Poppins",sans-serif;font-size:1.5rem;font-weight:600;color:#0D4C92}
    .nav__logo-text strong{color:#F4B400}
    .nav__menu{display:flex;list-style:none;margin:0;padding:0;gap:32px;align-items:center}
    .nav__menu li{margin:0;padding:0}
    .nav__menu a{color:#1E1E1E;text-decoration:none;font-weight:500;font-size:1rem;transition:color 0.3s ease;position:relative;display:inline-block;padding:4px 0}
    .nav__menu a:hover,.nav__menu a:focus{color:#F4B400}
    .nav__cta{flex-shrink:0;display:inline-flex;align-items:center;gap:8px;padding:12px 24px;background:#F4B400;color:#1E1E1E;border:none;border-radius:6px;font-weight:500;font-size:1rem;text-decoration:none;min-height:44px;transition:all 0.2s}
    .nav__toggle{display:none;background:none;border:none;cursor:pointer;padding:8px;min-height:44px;min-width:44px}
    .nav__toggle-icon{display:block;width:28px;height:2px;background:#1E1E1E;position:relative;transition:background 0.3s}
    .nav__toggle-icon::before,.nav__toggle-icon::after{content:'';position:absolute;width:28px;height:2px;background:#1E1E1E;left:0;transition:all 0.3s}
    .nav__toggle-icon::before{top:-8px}
    .nav__toggle-icon::after{bottom:-8px}
    .nav__toggle[aria-expanded="true"] .nav__toggle-icon{background:transparent}
    .nav__toggle[aria-expanded="true"] .nav__toggle-icon::before{top:0;transform:rotate(45deg)}
    .nav__toggle[aria-expanded="true"] .nav__toggle-icon::after{bottom:0;transform:rotate(-45deg)}
    @media (max-width:900px){
      .nav__toggle{display:inline-flex;align-items:center;justify-content:center}
      .nav__menu{display:none;position:absolute;top:100%;left:0;right:0;background:#fff;flex-direction:column;gap:16px;padding:16px;box-shadow:0 4px 6px rgba(0,0,0,0.1)}
      .nav__menu.is-open{display:flex}
      .nav__cta{display:none}
    }

    /* Footer - Critical (Unified Simple Design) */
    .site-footer{background:#2c3e50;color:#fff;padding:3rem 0 1rem}
    .footer-main{display:grid;grid-template-columns:2fr 1fr 1fr 1fr 1fr;gap:2rem;padding-bottom:2rem}
    .footer-brand{color:rgba(255,255,255,0.9)}
    .footer-brand__text{font-size:1.25rem;font-weight:600;margin-bottom:0.75rem}
    .footer-brand p{margin:0.5rem 0;font-size:0.875rem;line-height:1.6}
    .footer-brand a{color:rgba(255,255,255,0.8);text-decoration:none;transition:color .2s}
    .footer-brand a:hover{color:#fff}
    .footer-col{color:rgba(255,255,255,0.9)}
    .footer-nav__title{font-size:1rem;font-weight:600;margin-bottom:1rem;color:#fff}
    .footer-nav__list{list-style:none;margin:0;padding:0}
    .footer-nav__list li{margin-bottom:0.5rem}
    .footer-nav__list a{color:rgba(255,255,255,0.75);text-decoration:none;font-size:0.875rem;transition:color .2s}
    .footer-nav__list a:hover{color:#fff}
    .footer-social__list{list-style:none;margin:0;padding:0}
    .footer-social__list li{margin-bottom:0.5rem}
    .footer-social__list a{color:rgba(255,255,255,0.75);text-decoration:none;font-size:0.875rem;transition:color .2s}
    .footer-social__list a:hover{color:#fff}
    .footer-bottom{border-top:1px solid rgba(255,255,255,0.15);padding-top:1.5rem;margin-top:1rem}
    .footer-bottom__wrap{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;font-size:0.875rem}
    .footer-bottom__legal{display:flex;gap:0.5rem;align-items:center;flex-wrap:wrap}
    .footer-bottom__legal a{color:rgba(255,255,255,0.7);text-decoration:none;transition:color .2s}
    .footer-bottom__legal a:hover{color:#fff}
    @media (max-width:900px){
      .footer-main{grid-template-columns:1fr 1fr;gap:2rem}
    }
    @media (max-width:560px){
      .footer-main{grid-template-columns:1fr;gap:2rem}
    }

    /* Loading State */
    @media (prefers-reduced-motion:reduce){*{animation-duration:0.01ms!important;animation-iteration-count:1!important;transition-duration:0.01ms!important}}

    /* Booking Actions - Two-Button Choice */
    .booking-actions{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1.5rem}
    .action-btn{display:flex;align-items:center;gap:0.75rem;padding:1rem;border:2px solid #E3E3E3;border-radius:8px;background:#fff;cursor:pointer;transition:all 0.2s;min-height:80px;text-align:left;width:100%}
    .action-btn:hover{border-color:#0D4C92;transform:translateY(-2px);box-shadow:0 4px 12px rgba(13,76,146,0.15)}
    .action-btn:active{transform:translateY(0)}
    .action-btn.active{border-color:#0D4C92;background:#F0F7FF;box-shadow:0 0 0 3px rgba(13,76,146,0.1)}
    .action-btn i{font-size:1.5rem;color:#0D4C92;flex-shrink:0}
    .action-btn--booking i{color:#4CAF50}
    .action-btn--inquiry i{color:#FF9800}
    .action-btn__content{display:flex;flex-direction:column;gap:0.25rem}
    .action-btn__title{font-size:1rem;font-weight:600;color:#1E1E1E}
    .action-btn__subtitle{font-size:0.875rem;color:#666;line-height:1.3}
    @media (max-width:640px){.booking-actions{grid-template-columns:1fr;gap:0.75rem}}

    /* Form Section Visibility */
    #message-section{margin-top:1rem}

    /* ===================================================================
       BOOKING CONFIRMATION MODAL STYLES
       =================================================================== */
    .modal-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.75);
      z-index: 99999;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      animation: fadeIn 0.2s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-container {
      background: #ffffff;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      animation: slideUp 0.3s ease-out;
      position: relative;
    }

    @keyframes slideUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .modal-header {
      text-align: center;
      padding: 2rem 2rem 1.5rem;
      border-bottom: 1px solid #e5e7eb;
      position: relative;
    }

    .success-icon {
      width: 72px; height: 72px;
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 1rem;
      box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
    }

    .modal-title {
      font-size: 1.75rem;
      font-weight: 700;
      color: #111827;
      margin-bottom: 0.5rem;
    }

    .modal-subtitle {
      font-size: 1rem;
      color: #6b7280;
      margin: 0;
    }

    .modal-close {
      position: absolute;
      top: 1rem; right: 1rem;
      width: 36px; height: 36px;
      border: none;
      background: #f3f4f6;
      color: #6b7280;
      font-size: 24px;
      line-height: 1;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-close:hover {
      background: #e5e7eb;
      color: #111827;
    }

    .modal-body {
      padding: 2rem;
    }

    .confirmation-reference {
      text-align: center;
      background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
      padding: 1.5rem;
      border-radius: 12px;
      margin-bottom: 2rem;
      border: 2px solid #3b82f6;
    }

    .confirmation-reference .label {
      display: block;
      font-size: 0.875rem;
      color: #1e40af;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.5rem;
    }

    .reference-number {
      display: block;
      font-size: 2rem;
      font-weight: 700;
      color: #1e3a8a;
      letter-spacing: 2px;
      font-family: 'Courier New', monospace;
      margin-bottom: 0.25rem;
    }

    .reference-note {
      font-size: 0.875rem;
      color: #3b82f6;
      margin: 0;
    }

    .booking-summary,
    .customer-info,
    .next-steps {
      margin-bottom: 2rem;
    }

    .section-title {
      font-size: 1.125rem;
      font-weight: 600;
      color: #111827;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
    }

    .summary-grid {
      border: 1px solid #e5e7eb;
      border-radius: 8px;
      overflow: hidden;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      border-bottom: 1px solid #e5e7eb;
      background: #ffffff;
    }

    .summary-item:last-child {
      border-bottom: none;
    }

    .summary-item--total {
      background: #f9fafb;
      font-weight: 600;
    }

    .summary-item .label {
      color: #6b7280;
      font-size: 0.875rem;
      font-weight: 500;
    }

    .summary-item .value {
      color: #111827;
      font-weight: 600;
      text-align: right;
    }

    .summary-item .value.highlight {
      color: #059669;
      font-size: 1.25rem;
    }

    .email-address {
      font-size: 1rem;
      color: #2563eb;
      font-weight: 600;
      background: #eff6ff;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      text-align: center;
    }

    .steps-list {
      margin: 0;
      padding-left: 1.5rem;
      color: #374151;
      line-height: 1.8;
    }

    .steps-list li {
      margin-bottom: 0.75rem;
    }

    .steps-list strong {
      color: #111827;
    }

    .important-note {
      display: flex;
      gap: 0.75rem;
      background: #fef3c7;
      border-left: 4px solid #f59e0b;
      padding: 1rem;
      border-radius: 8px;
      align-items: flex-start;
    }

    .warning-icon {
      flex-shrink: 0;
      color: #d97706;
    }

    .important-note p {
      margin: 0;
      color: #78350f;
      font-size: 0.875rem;
      line-height: 1.6;
    }

    .modal-footer {
      padding: 1.5rem 2rem 2rem;
      border-top: 1px solid #e5e7eb;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .btn--large {
      padding: 0.875rem 1.5rem;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn--primary {
      background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
      color: white;
      box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3);
    }

    .btn--primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
    }

    .btn--secondary {
      background: #f3f4f6;
      color: #374151;
    }

    .btn--secondary:hover {
      background: #e5e7eb;
    }

    /* Mobile Responsive */
    @media (max-width: 640px) {
      .modal-container {
        max-height: 95vh;
        border-radius: 12px;
      }

      .modal-header {
        padding: 1.5rem 1.5rem 1rem;
      }

      .modal-title {
        font-size: 1.5rem;
      }

      .reference-number {
        font-size: 1.5rem;
      }

      .modal-body {
        padding: 1.5rem;
      }

      .summary-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.25rem;
      }

      .summary-item .value {
        text-align: left;
      }

      .modal-footer {
        padding: 1rem 1.5rem 1.5rem;
      }
    }
  </style>

  <!-- Tour details stylesheet - guaranteed load -->
  <link rel="preload" href="/tour-details.css" as="style">
  <link rel="stylesheet" href="/tour-details.css">

  <!-- Favicon (TODO: Add favicon.png to /images directory) -->
  <!-- <link rel="icon" type="image/png" href="/images/favicon.png"> -->

  <!-- Tour JSON-LD Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Tour",
    "name": "Samarkand City Tour: Registan Square and Historic Monuments",
    "description": "Explore the magnificent Registan Square, Shah-i-Zinda necropolis, and Bibi-Khanym Mosque on this comprehensive 4-hour walking tour of Samarkand's UNESCO World Heritage sites.",
    "image": [
      "https://jahongirtravel.com/images/tours/samarkand/hero-main.webp",
      "https://jahongirtravel.com/images/tours/samarkand/registan-1.webp",
      "https://jahongirtravel.com/images/tours/samarkand/shah-i-zinda.webp"
    ],
    "provider": {
      "@type": "Organization",
      "name": "Jahongir Travel",
      "url": "https://jahongirtravel.com",
      "logo": "https://jahongirtravel.com/images/logo.png",
      "telephone": "+998-90-123-45-67",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Samarkand",
        "addressCountry": "UZ"
      }
    },
    "touristType": "Private Activity",
    "duration": "PT4H",
    "inLanguage": ["en", "ru", "fr"],
    "availableLanguage": [
      {
        "@type": "Language",
        "name": "English"
      },
      {
        "@type": "Language",
        "name": "Russian"
      },
      {
        "@type": "Language",
        "name": "French"
      }
    ],
    "itinerary": {
      "@type": "ItemList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "item": {
            "@type": "TouristAttraction",
            "name": "Registan Square"
          }
        },
        {
          "@type": "ListItem",
          "position": 2,
          "item": {
            "@type": "TouristAttraction",
            "name": "Shah-i-Zinda Necropolis"
          }
        },
        {
          "@type": "ListItem",
          "position": 3,
          "item": {
            "@type": "TouristAttraction",
            "name": "Bibi-Khanym Mosque"
          }
        }
      ]
    },
    "offers": {
      "@type": "Offer",
      "price": "50.00",
      "priceCurrency": "USD",
      "priceSpecification": {
        "@type": "PriceSpecification",
        "price": "50.00",
        "priceCurrency": "USD",
        "valueAddedTaxIncluded": true
      },
      "availability": "https://schema.org/InStock",
      "validFrom": "2025-01-01",
      "priceValidUntil": "2025-12-31",
      "url": "https://jahongirtravel.com/tours/samarkand-city-tour",
      "seller": {
        "@type": "Organization",
        "name": "Jahongir Travel"
      }
    },
    "includesObject": [
      {
        "@type": "Thing",
        "name": "Hotel pickup and drop-off"
      },
      {
        "@type": "Thing",
        "name": "Professional guide"
      },
      {
        "@type": "Thing",
        "name": "Entrance fees to monuments"
      },
      {
        "@type": "Thing",
        "name": "Bottled water"
      }
    ],
    "additionalInfo": "Not included: Tips, personal expenses, lunch",
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "5.0",
      "reviewCount": "47",
      "bestRating": "5",
      "worstRating": "1"
    },
    "review": [
      {
        "@type": "Review",
        "reviewRating": {
          "@type": "Rating",
          "ratingValue": "5",
          "bestRating": "5"
        },
        "author": {
          "@type": "Person",
          "name": "Sarah Mitchell"
        },
        "datePublished": "2024-10-15",
        "reviewBody": "Absolutely breathtaking! Our guide was incredibly knowledgeable about the history of Samarkand and made every monument come alive with stories. The Registan Square at sunset was magical. Highly recommend this tour to anyone visiting Uzbekistan."
      },
      {
        "@type": "Review",
        "reviewRating": {
          "@type": "Rating",
          "ratingValue": "5",
          "bestRating": "5"
        },
        "author": {
          "@type": "Person",
          "name": "James Chen"
        },
        "datePublished": "2024-09-28",
        "reviewBody": "Perfect tour for photography enthusiasts! Our guide knew all the best spots and angles for photos. The Shah-i-Zinda necropolis was stunning with its blue tiles. Great pace, not rushed at all. Worth every penny!"
      },
      {
        "@type": "Review",
        "reviewRating": {
          "@type": "Rating",
          "ratingValue": "5",
          "bestRating": "5"
        },
        "author": {
          "@type": "Person",
          "name": "Emma Dubois"
        },
        "datePublished": "2024-08-12",
        "reviewBody": "An unforgettable experience! The guide spoke excellent French and English. The small group size meant we could ask lots of questions. Bibi-Khanym Mosque was incredible. Hotel pickup was punctual. Thank you, Jahongir Travel!"
      },
      {
        "@type": "Review",
        "reviewRating": {
          "@type": "Rating",
          "ratingValue": "5",
          "bestRating": "5"
        },
        "author": {
          "@type": "Person",
          "name": "Michael O'Brien"
        },
        "datePublished": "2024-07-22",
        "reviewBody": "Best tour we did in Central Asia! The architecture is mind-blowing and our guide's passion for Samarkand's history was contagious. Four hours flew by. Great value for money. Would definitely book with Jahongir Travel again."
      }
    ]
  }
  </script>
  <link rel="stylesheet" href="/css/gallery-lightbox.css">
  <link rel="stylesheet" href="/tour-details-gallery-addon.css">
  <link rel="stylesheet" href="/css/tour-reviews.css">
</head>
<body>

  <!-- Skip to Main Content (Accessibility) -->
  <a href="#main-content" class="skip-link">Skip to main content</a>

  <!-- =====================================================
       SITE HEADER / NAVIGATION
       ===================================================== -->
  <header class="site-header" role="banner">
    <!-- Navigation Bar -->
    <nav class="nav" aria-label="Main navigation">
      <div class="container">
        <a href="/" class="nav__logo">
          <span class="nav__logo-text">Jahongir <strong>Travel</strong></span>
        </a>

        <ul class="nav__menu" id="navMenu">
          <li><a href="/">Home</a></li>
          <li><a href="/tours/">Tours</a></li>
          <li><a href="/destinations/">Destinations</a></li>
          <li><a href="/about/">About Us</a></li>
          <li><a href="/contact/">Contact</a></li>
        </ul>

        <a href="tel:+998991234567" class="btn btn--accent nav__cta">
          <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M6.62 10.79a15.09 15.09 0 006.59 6.59l2.2-2.2a1 1 0 011.11-.24 11.72 11.72 0 003.67.59 1 1 0 011 1v3.54a1 1 0 01-1 1A18.5 18.5 0 013 5a1 1 0 011-1h3.55a1 1 0 011 1 11.72 11.72 0 00.59 3.67 1 1 0 01-.25 1.11z"/>
          </svg>
          +998 99 123 4567
        </a>

        <button class="nav__toggle" id="navToggle" aria-label="Toggle navigation menu" aria-expanded="false">
          <span class="nav__toggle-icon"></span>
        </button>
      </div>
    </nav>
  </header>

  <!-- =====================================================
       SECTION 2: TOUR HEADER INFO (Title, Rating, Meta, Tabs)
       ===================================================== -->
  <section class="tour-header"
           hx-get="http://127.0.0.1:8000/partials/tours/samarkand-city-toursregistan-square-and-historical/hero"
           hx-trigger="none"
           hx-swap="innerHTML"
           data-tour-slug="samarkand-city-toursregistan-square-and-historical">

    <!-- Loading Skeleton -->
    <div class="container">
      <div class="skeleton skeleton--text" style="width: 40%; height: 16px; margin-bottom: 1rem;"></div>
      <div class="skeleton skeleton--title" style="height: 40px; width: 80%; margin-bottom: 1rem;"></div>
      <div class="skeleton skeleton--text" style="width: 30%; height: 20px;"></div>
    </div>

  </section>

  <!-- =====================================================
       SECTION 3: TOUR HERO GALLERY
       ===================================================== -->
  <section class="tour-hero">
    <div class="container">

      <!-- Skeleton Loader (hidden once loaded) -->
      <div class="tour-hero__skeleton" aria-hidden="true">
        <div class="skeleton skeleton--hero"></div>
        <div class="skeleton skeleton--thumbnails">
          <div class="skeleton skeleton--thumb"></div>
          <div class="skeleton skeleton--thumb"></div>
          <div class="skeleton skeleton--thumb"></div>
          <div class="skeleton skeleton--thumb"></div>
        </div>
      </div>

      <!-- Actual Gallery -->
      <!-- Actual Gallery - Loaded via HTMX -->
      <div class="tour-hero__gallery is-hidden"
           hx-get=""
           hx-trigger="none"
           hx-swap="innerHTML"
           data-tour-slug="samarkand-city-toursregistan-square-and-historical">
      </div>
    </div>
  </section>

  <!-- Section Navigation with Arrows -->
  <div class="container section-nav-wrapper">
    <nav class="section-nav" aria-label="Tour sections">
      <button class="section-nav__btn section-nav__btn--prev" aria-label="Scroll left" hidden>
        ‹
      </button>

      <div class="section-nav__scroller" id="sectionScroller">
        <a href="#overview" class="is-active">Overview</a>
        <a href="#highlights">Highlights</a>
        <a href="#includes">Included</a>
        <a href="#cancellation">Cancellation</a>
        <a href="#itinerary">Itinerary</a>
        <a href="#meeting-point">Meeting Point</a>
        <a href="#know-before">Know Before</a>
        <a href="#faq">FAQ</a>
      </div>

      <button class="section-nav__btn section-nav__btn--next" aria-label="Scroll right" hidden>
        ›
      </button>
    </nav>
  </div>


  <!-- =====================================================
       TWO-COLUMN LAYOUT: MAIN CONTENT + BOOKING SIDEBAR
       ===================================================== -->
  <div class="tour-content-wrapper">
    <div class="container">
      <div class="tour-layout">

        <!-- LEFT COLUMN: Main Tour Content -->
        <main class="tour-main-content" id="main-content">

          <!-- Overview Section -->
          <section class="tour-overview" id="overview"
                   hx-get="http://127.0.0.1:8000/partials/tours/samarkand-city-toursregistan-square-and-historical/overview"
                   hx-trigger="none"
                   hx-swap="innerHTML"
                   data-tour-slug="samarkand-city-toursregistan-square-and-historical">

            <!-- Loading Skeleton -->
            <h2 class="section-title">Overview</h2>
            <div class="skeleton skeleton--text" style="width: 90%; height: 16px; margin-bottom: 0.5rem;"></div>
            <div class="skeleton skeleton--text" style="width: 85%; height: 16px; margin-bottom: 0.5rem;"></div>
            <div class="skeleton skeleton--text" style="width: 92%; height: 16px; margin-bottom: 0.5rem;"></div>
            <div class="skeleton skeleton--text" style="width: 88%; height: 16px; margin-bottom: 0.5rem;"></div>

          </section>

          <!-- Highlights Section -->
          <section class="tour-highlights" id="highlights"
                   hx-get="http://127.0.0.1:8000/partials/tours/samarkand-city-toursregistan-square-and-historical/highlights"
                   hx-trigger="none"
                   hx-swap="innerHTML"
                   data-tour-slug="samarkand-city-toursregistan-square-and-historical">

            <!-- Loading Skeleton -->
            <h2 class="section-title">Highlights</h2>
            <div class="skeleton skeleton--text" style="width: 95%; height: 16px; margin-bottom: 0.5rem;"></div>
            <div class="skeleton skeleton--text" style="width: 92%; height: 16px; margin-bottom: 0.5rem;"></div>
            <div class="skeleton skeleton--text" style="width: 88%; height: 16px; margin-bottom: 0.5rem;"></div>

          </section>

          <!-- Includes/Excludes Section -->
          <section class="tour-includes-excludes" id="includes"
                   hx-get="http://127.0.0.1:8000/partials/tours/samarkand-city-toursregistan-square-and-historical/included-excluded"
                   hx-trigger="none"
                   hx-swap="innerHTML"
                   data-tour-slug="samarkand-city-toursregistan-square-and-historical">

            <!-- Loading Skeleton -->
            <h2 class="section-title">What's Included & Excluded</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
              <div>
                <div class="skeleton skeleton--text" style="width: 90%; height: 16px; margin-bottom: 0.5rem;"></div>
                <div class="skeleton skeleton--text" style="width: 85%; height: 16px; margin-bottom: 0.5rem;"></div>
                <div class="skeleton skeleton--text" style="width: 92%; height: 16px; margin-bottom: 0.5rem;"></div>
              </div>
              <div>
                <div class="skeleton skeleton--text" style="width: 88%; height: 16px; margin-bottom: 0.5rem;"></div>
                <div class="skeleton skeleton--text" style="width: 93%; height: 16px; margin-bottom: 0.5rem;"></div>
                <div class="skeleton skeleton--text" style="width: 87%; height: 16px; margin-bottom: 0.5rem;"></div>
              </div>
            </div>

          </section>

          <!-- Cancellation Policy Section -->
          <section class="tour-cancellation" id="cancellation"
                   data-tour-slug="samarkand-city-toursregistan-square-and-historical"
                   hx-get="http://127.0.0.1:8000/partials/tours/samarkand-city-toursregistan-square-and-historical/cancellation"
                   hx-trigger="none"
                   hx-swap="innerHTML">
            <div class="loading-spinner">Loading cancellation policy...</div>
          </section>

          <!-- Itinerary Section -->
          <section class="tour-itinerary" id="itinerary"
                   hx-get="http://127.0.0.1:8000/partials/tours/samarkand-city-toursregistan-square-and-historical/itinerary"
                   hx-trigger="none"
                   hx-swap="innerHTML"
                   aria-label="Tour itinerary"
                   data-tour-slug="samarkand-city-toursregistan-square-and-historical">

            <!-- Loading Skeleton -->
            <div class="itinerary-header">
              <h2 class="section-title">Tour Itinerary</h2>
            </div>
            <div class="skeleton skeleton--text" style="width: 92%; height: 16px; margin-bottom: 0.5rem;"></div>
            <div class="skeleton skeleton--text" style="width: 88%; height: 16px; margin-bottom: 0.5rem;"></div>
            <div class="skeleton skeleton--text" style="width: 90%; height: 16px; margin-bottom: 0.5rem;"></div>
            <div class="skeleton skeleton--text" style="width: 85%; height: 16px; margin-bottom: 0.5rem;"></div>

          </section>

          <!-- Meeting Point & Pickup Section -->
          <section class="tour-meeting" id="meeting-point"
                   hx-get="http://127.0.0.1:8000/partials/tours/samarkand-city-toursregistan-square-and-historical/meeting-point"
                   hx-trigger="none"
                   hx-swap="innerHTML"
                   data-tour-slug="samarkand-city-toursregistan-square-and-historical">

            <!-- Loading Skeleton -->
            <h2 class="section-title">Meeting Point & Pickup</h2>
            <div class="skeleton skeleton--text" style="width: 95%; height: 16px; margin-bottom: 1rem;"></div>
            <div class="skeleton skeleton--text" style="width: 92%; height: 16px; margin-bottom: 1rem;"></div>
            <div class="skeleton skeleton--rect" style="width: 100%; height: 360px; margin-top: 2rem;"></div>
          </section>

          <!-- Know Before You Go Section -->
          <section class="tour-know-before" id="know-before"
                   hx-get="http://127.0.0.1:8000/partials/tours/5-day-silk-road-classic/requirements"
                   hx-trigger="none"
                   hx-swap="innerHTML"
                   data-tour-slug="samarkand-city-toursregistan-square-and-historical">

            <!-- Loading Skeleton -->
            <h2 class="section-title">Know Before You Go</h2>
            <div class="skeleton skeleton--text" style="width: 95%; height: 16px; margin-bottom: 1rem;"></div>
            <div class="skeleton skeleton--text" style="width: 92%; height: 16px; margin-bottom: 1rem;"></div>
            <div class="skeleton skeleton--text" style="width: 90%; height: 16px; margin-bottom: 1rem;"></div>
            <div class="skeleton skeleton--text" style="width: 88%; height: 16px; margin-bottom: 1rem;"></div>

          </section>

          <!-- FAQ Section -->
          <section class="tour-faq" id="faq"
                   hx-get="http://127.0.0.1:8000/partials/tours/samarkand-city-toursregistan-square-and-historical/faqs"
                   hx-trigger="none"
                   hx-swap="innerHTML"
                   data-tour-slug="samarkand-city-toursregistan-square-and-historical">

            <!-- Loading Skeleton -->
            <h2 class="section-title">Frequently Asked Questions</h2>
            <div class="skeleton skeleton--text" style="width: 95%; height: 16px; margin-bottom: 1rem;"></div>
            <div class="skeleton skeleton--text" style="width: 92%; height: 16px; margin-bottom: 1rem;"></div>
            <div class="skeleton skeleton--text" style="width: 90%; height: 16px; margin-bottom: 1rem;"></div>
            <div class="skeleton skeleton--text" style="width: 88%; height: 16px; margin-bottom: 1rem;"></div>

          </section>

          <!-- Extra Services Section -->
          <section class="tour-extras" id="extras"
                   hx-get="http://127.0.0.1:8000/partials/tours/samarkand-city-toursregistan-square-and-historical/extras"
                   hx-trigger="none"
                   hx-swap="innerHTML"
                   data-tour-slug="samarkand-city-toursregistan-square-and-historical">

            <!-- Loading Skeleton -->
            <h2 class="section-title">Extra Services</h2>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem;">
              <div class="skeleton skeleton--thumb"></div>
              <div class="skeleton skeleton--thumb"></div>
              <div class="skeleton skeleton--thumb"></div>
              <div class="skeleton skeleton--thumb"></div>
            </div>

          </section>

          <!-- Customer Reviews Section -->
          <section class="tour-reviews" id="reviews"
                   hx-get="http://127.0.0.1:8000/partials/tours/samarkand-city-toursregistan-square-and-historical/reviews"
                   hx-trigger="revealed"
                   hx-swap="innerHTML"
                   data-tour-slug="samarkand-city-toursregistan-square-and-historical">

            <!-- Loading Skeleton -->
            <div class="reviews-header">
              <h2 class="section-title">Customer Reviews</h2>
            </div>
            <div class="skeleton skeleton--text" style="width: 100%; height: 80px; margin-bottom: 1rem;"></div>
            <div class="skeleton skeleton--text" style="width: 100%; height: 80px; margin-bottom: 1rem;"></div>
            <div class="skeleton skeleton--text" style="width: 100%; height: 80px; margin-bottom: 1rem;"></div>

          </section>

        </main>

        <!-- RIGHT COLUMN: Booking Sidebar -->
        <aside class="booking-sidebar" data-sticky="true">

          <!-- Tour Data for JavaScript -->
          <script type="application/json" id="tour-data">
            {
              "id": "samarkand-city-tour",
              "name": "Samarkand City Tour: Registan Square and Historic Monuments",
              "pricePerPerson": 50.00,
              "currency": "USD",
              "maxGuests": 10,
              "minGuests": 1,
              "duration": "4 hours"
            }
          </script>

          <!-- Screen Reader Live Region for Dynamic Updates -->
          <div aria-live="polite" aria-atomic="true" class="sr-only" id="booking-status"></div>

          <!-- Skeleton Loader -->
          <div class="booking-sidebar__skeleton" aria-hidden="true">
            <div class="skeleton skeleton--sidebar-top"></div>
            <div class="skeleton skeleton--sidebar-inputs"></div>
            <div class="skeleton skeleton--sidebar-buttons"></div>
          </div>

          <!-- Booking Card -->
          <div class="booking-card">

            <!-- Price Header -->
            <div class="booking-card__header">
              <div class="booking-price">
                <span class="price-label">from</span>
                <span class="price-amount" data-base-price="50.00">$50.00</span>
                <span class="price-unit">/person</span>
              </div>
            </div>

            <!-- Price Breakdown -->
            <div class="price-breakdown" data-breakdown-visible="true">
              <h3 class="breakdown-title">Price Breakdown</h3>
              <div class="breakdown-items">
                <div class="breakdown-item">
                  <span class="breakdown-label">
                    <span class="breakdown-guests" data-guests="2">2 guests</span> ×
                    <span class="breakdown-unit-price" data-unit-price="50.00">$50.00</span>
                  </span>
                  <span class="breakdown-value" data-subtotal="100.00">$100.00</span>
                </div>
                <div class="breakdown-item breakdown-item--total">
                  <span class="breakdown-label">Total</span>
                  <span class="breakdown-value breakdown-total" data-total="100.00">$100.00</span>
                </div>
              </div>
              <p class="breakdown-note">Free cancellation up to 24 hours before the tour</p>
            </div>

            <!-- Booking Form -->
            <form class="booking-form" id="booking-form" data-form-type="booking" action="/partials/bookings" method="POST">
              <!-- Hidden fields -->
              <input type="hidden" name="_token" id="csrf-token" value="">
              <input type="hidden" name="tour_id" id="tour-id" value="">

              <!-- Date Picker -->
              <div class="form-group">
                <label for="tour-date" class="form-label">
                  Date
                </label>
                <input
                  type="date"
                  id="tour-date"
                  name="tour-date"
                  class="form-input"
                  required
                  aria-required="true"
                  aria-describedby="date-hint date-error"
                  autocomplete="off"
                  min=""
                  data-min-date-offset="1">
                <span id="date-hint" class="form-hint">Select your preferred tour date (at least 24 hours in advance)</span>
                <span id="date-error" class="form-error" role="alert"></span>
              </div>

              <!-- Guest Selector -->
              <div class="form-group">
                <label for="tour-guests" class="form-label">
                  Guest
                </label>
                <select
                  id="tour-guests"
                  name="tour-guests"
                  class="form-input"
                  required
                  aria-required="true"
                  aria-describedby="guests-hint guests-error"
                  autocomplete="off"
                  data-price-calculator="true">
                  <option value="1">1 guest</option>
                  <option value="2" selected>2 guests</option>
                  <option value="3">3 guests</option>
                  <option value="4">4 guests</option>
                  <option value="5">5 guests</option>
                  <option value="6">6 guests</option>
                  <option value="7">7 guests</option>
                  <option value="8">8 guests</option>
                  <option value="9">9 guests</option>
                  <option value="10">10 guests</option>
                </select>
                <span id="guests-hint" class="form-hint">Maximum 10 guests per booking</span>
                <span id="guests-error" class="form-error" role="alert"></span>
              </div>

              <!-- Action Buttons: Book or Inquire -->
              <div class="booking-actions">
                <button type="button" class="action-btn action-btn--booking" data-action="booking">
                  <i class="fas fa-calendar-check"></i>
                  <div class="action-btn__content">
                    <span class="action-btn__title">Book This Tour</span>
                    <span class="action-btn__subtitle">Confirm your dates & guests</span>
                  </div>
                </button>

                <button type="button" class="action-btn action-btn--inquiry" data-action="inquiry">
                  <i class="fas fa-question-circle"></i>
                  <div class="action-btn__content">
                    <span class="action-btn__title">Ask a Question</span>
                    <span class="action-btn__subtitle">Get personalized information</span>
                  </div>
                </button>
              </div>

              <!-- STEP 2: Full Booking Form (Hidden Initially) -->
              <div id="step-2-full-form" style="display: none;">

                <!-- Customer Information -->
                <div class="form-section">
                  <h3 class="form-section__title">Your Information</h3>

                  <div class="form-group">
                    <label for="customer-name" class="form-label">
                      Full Name <span class="required">*</span>
                    </label>
                    <input type="text"
                           id="customer-name"
                           name="customer_name"
                           class="form-input"
                           placeholder="John Doe"
                           required>
                  </div>

                  <div class="form-group">
                    <label for="customer-email" class="form-label">
                      Email <span class="required">*</span>
                    </label>
                    <input type="email"
                           id="customer-email"
                           name="customer_email"
                           class="form-input"
                           placeholder="john@example.com"
                           required>
                  </div>

                  <div class="form-group">
                    <label for="customer-phone" class="form-label">
                      Phone <span class="required">*</span>
                    </label>
                    <input type="tel"
                           id="customer-phone"
                           name="customer_phone"
                           class="form-input"
                           placeholder="+998 91 123 45 67"
                           required>
                  </div>

                  <div class="form-group">
                    <label for="customer-country" class="form-label">
                      Country (Optional)
                    </label>
                    <input type="text"
                           id="customer-country"
                           name="customer_country"
                           class="form-input"
                           placeholder="United States">
                  </div>
                </div>

                <!-- Hidden field to track action type -->
                <input type="hidden" name="action_type" id="action-type" value="booking">

                <!-- Message Field (Required for Inquiry, Optional for Booking) -->
                <div class="form-section" id="message-section" style="display: none;">
                  <div class="form-group">
                    <label for="inquiry-message" class="form-label">
                      Your Message <span class="required" id="message-required">*</span>
                    </label>
                    <textarea id="inquiry-message"
                              name="message"
                              class="form-input"
                              rows="4"
                              placeholder="Please tell us about your questions or any specific requirements..."></textarea>
                    <span class="form-hint">Let us know what information you need about this tour</span>
                  </div>
                </div>

                <!-- Special Requests -->
                <div class="form-section">
                  <div class="form-group">
                    <label for="special-requests" class="form-label">
                      Special Requests (Optional)
                    </label>
                    <textarea id="special-requests"
                              name="special_requests"
                              class="form-input"
                              rows="3"
                              placeholder="Any special requirements or preferences?"></textarea>
                  </div>
                </div>

                <!-- Terms & Conditions -->
                <div class="form-section">
                  <label class="terms-checkbox__label">
                    <input type="checkbox"
                           name="agree_terms"
                           id="agree-terms"
                           class="terms-checkbox__input"
                           required>
                    <span class="terms-checkbox__text">
                      I agree to the <a href="/terms" target="_blank">Terms & Conditions</a>
                      and <a href="/privacy" target="_blank">Privacy Policy</a>
                    </span>
                  </label>
                </div>

                <!-- Submit Button -->
                <div class="form-actions">
                  <button type="submit" class="btn--submit btn--block" id="submit-button">
                    <span class="btn__text" id="submit-text">Send Booking Request</span>
                    <span class="spinner"></span>
                  </button>
                </div>

              </div><!-- End Step 2 -->

            </form>

            <!-- Trust Badges -->
            <div class="trust-badges">
              <div class="badge-item">
                <svg class="icon icon--shield" width="18" height="20" viewBox="0 0 18 20" fill="currentColor" aria-hidden="true"><path d="M9 0L0 3v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V3L9 0zm0 2.18l7 2.09v5.23c0 4.65-3.19 8.98-7 10.05-3.81-1.07-7-5.4-7-10.05V4.27l7-2.09z"/></svg>
                <span>Secure payments</span>
              </div>
              <div class="badge-item">
                <svg class="icon icon--headset" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M10 0C4.5 0 0 4.5 0 10v5a3 3 0 003 3h2v-8H2v-2a8 8 0 1116 0v2h-3v8h2a3 3 0 003-3v-5c0-5.5-4.5-10-10-10z"/></svg>
                <span>24/7 support</span>
              </div>
              <div class="badge-item">
                <svg class="icon icon--undo" width="18" height="18" viewBox="0 0 18 18" fill="currentColor" aria-hidden="true"><path d="M2 8a6 6 0 1110.89 3.5.5.5 0 10.78.63A7 7 0 103 8h3l-4-4-4 4h3z"/></svg>
                <span>Free cancellation</span>
              </div>
            </div>

            <!-- Booking Clarification -->
            <div class="booking-clarification">
              <p class="clarification-text">
                <svg class="icon icon--clock" width="18" height="18" viewBox="0 0 18 18" fill="currentColor" aria-hidden="true"><path d="M9 0a9 9 0 100 18A9 9 0 009 0zm4 10H9a1 1 0 01-1-1V4a1 1 0 112 0v4h3a1 1 0 010 2z"/></svg>
                <strong>Confirmation within 24 hours</strong> — we'll verify availability and send you a confirmation.
              </p>
              <p class="clarification-note">
                No payment required now. Pay after confirmation.
              </p>
            </div>

            <!-- Request to Book Button -->
            <button type="button" class="btn btn--accent btn--block btn--large" id="request-booking">
              <svg class="icon icon--check-circle" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M10 0C4.477 0 0 4.477 0 10s4.477 10 10 10 10-4.477 10-10S15.523 0 10 0zm5.707 7.707l-7 7a1 1 0 01-1.414 0l-3-3a1 1 0 111.414-1.414L8 12.586l6.293-6.293a1 1 0 111.414 1.414z"/></svg>
              Request to Book
            </button>

            <!-- Why Book Section -->
            <div class="booking-benefits">
              <h3 class="benefits-title">Why book with Jahongir Travel?</h3>
              <ul class="benefits-list">
                <li class="benefit-item">
                  <svg class="icon icon--check-circle" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M10 0C4.477 0 0 4.477 0 10s4.477 10 10 10 10-4.477 10-10S15.523 0 10 0zm5.707 7.707l-7 7a1 1 0 01-1.414 0l-3-3a1 1 0 111.414-1.414L8 12.586l6.293-6.293a1 1 0 111.414 1.414z"/></svg>
                  <span>Best price guarantee</span>
                </li>
                <li class="benefit-item">
                  <svg class="icon icon--check-circle" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M10 0C4.477 0 0 4.477 0 10s4.477 10 10 10 10-4.477 10-10S15.523 0 10 0zm5.707 7.707l-7 7a1 1 0 01-1.414 0l-3-3a1 1 0 111.414-1.414L8 12.586l6.293-6.293a1 1 0 111.414 1.414z"/></svg>
                  <span>Free cancellation (24h)</span>
                </li>
                <li class="benefit-item">
                  <svg class="icon icon--check-circle" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M10 0C4.477 0 0 4.477 0 10s4.477 10 10 10 10-4.477 10-10S15.523 0 10 0zm5.707 7.707l-7 7a1 1 0 01-1.414 0l-3-3a1 1 0 111.414-1.414L8 12.586l6.293-6.293a1 1 0 111.414 1.414z"/></svg>
                  <span>Expert local guides</span>
                </li>
                <li class="benefit-item">
                  <svg class="icon icon--check-circle" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M10 0C4.477 0 0 4.477 0 10s4.477 10 10 10 10-4.477 10-10S15.523 0 10 0zm5.707 7.707l-7 7a1 1 0 01-1.414 0l-3-3a1 1 0 111.414-1.414L8 12.586l6.293-6.293a1 1 0 111.414 1.414z"/></svg>
                  <span>24/7 customer support</span>
                </li>
              </ul>
            </div>

            <!-- WhatsApp Contact -->
            <div class="booking-contact">
              <p class="contact-text">Questions? Contact us directly:</p>
              <a href="https://wa.me/998901234567" class="btn btn--whatsapp btn--block" target="_blank" rel="noopener noreferrer">
                <svg class="icon icon--whatsapp" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M10.05 0C4.5 0 0 4.48 0 10c0 1.77.46 3.43 1.27 4.87L.05 19.1l4.35-1.14A9.95 9.95 0 0010.05 20c5.52 0 10-4.48 10-10s-4.48-10-10-10zm5.89 14.21c-.24.68-1.41 1.28-1.95 1.35-.51.06-1.02.24-3.44-.74-3.11-1.25-5.11-4.39-5.27-4.59-.15-.2-1.24-1.65-1.24-3.15s.78-2.23 1.06-2.53c.28-.3.61-.38.81-.38.2 0 .41.01.59.01.19 0 .44-.07.69.52.25.61.86 2.1.93 2.25.08.15.13.33.03.53-.1.2-.15.33-.3.51-.15.18-.32.4-.46.54-.15.15-.31.31-.13.61.18.3.79 1.31 1.7 2.12 1.17 1.04 2.16 1.37 2.46 1.52.3.15.48.13.66-.08.18-.2.76-.89.96-1.19.2-.3.41-.25.69-.15.28.1 1.78.84 2.08.99.3.15.5.23.58.35.07.13.07.74-.17 1.42z"/></svg>
                WhatsApp: +998 90 123 45 67
              </a>
            </div>

          </div>

        </aside>

      </div>
    </div>
  </div>

  <!-- Mobile Floating CTA (Task 13) -->
  <!-- Hidden on desktop, visible on mobile/tablet only via CSS -->
  <div class="mobile-booking-cta" data-mobile-only="true">
    <div class="mobile-cta__container">
      <div class="mobile-cta__price">
        <span class="mobile-cta__amount" data-mobile-price="50.00">$50.00</span>
        <span class="mobile-cta__unit">per person</span>
      </div>
      <button type="button" class="btn btn--accent mobile-cta__button" data-scroll-to="booking-form" aria-label="Scroll to booking form">
        <svg class="icon icon--calendar-check" width="20" height="20" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M6 2a2 2 0 00-2 2v1H2a2 2 0 00-2 2v10a2 2 0 002 2h14a2 2 0 002-2V7a2 2 0 00-2-2h-2V4a2 2 0 00-2-2H6zm1 2h4v2H7V4zM2 9h14v8H2V9zm11.707 1.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 10-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"/></svg>
        Book Now
      </button>
    </div>
  </div>

  <!-- =====================================================
       FOOTER
       ===================================================== -->
  <footer class="site-footer">
    <div class="container footer-main footer-main--desktop">
      <div class="footer-brand">
        <div class="footer-brand__text">Jahongir Travel</div>
        <p>Tailor-made Uzbekistan tours since 2012.</p>
        <p><a href="mailto:info@jahongirtravel.com">info@jahongirtravel.com</a></p>
        <p><a href="tel:+998991234567">+998 99 123 4567</a></p>
        <p>Samarkand, Uzbekistan</p>
      </div>

      <nav class="footer-col footer-nav" aria-label="Company">
        <div class="footer-nav__title">Company</div>
        <ul class="footer-nav__list">
          <li><a href="/about/">About us</a></li>
          <li><a href="/careers/">Careers</a></li>
          <li><a href="/blog/">Blog</a></li>
          <li><a href="/partners/">Partner</a></li>
          <li><a href="/contact/">Contact</a></li>
        </ul>
      </nav>

      <nav class="footer-col footer-nav" aria-label="Services">
        <div class="footer-nav__title">Services</div>
        <ul class="footer-nav__list">
          <li><a href="/tours/">Tour booking</a></li>
          <li><a href="/visa/">Visa online</a></li>
          <li><a href="/guides/">Travel guide</a></li>
          <li><a href="/car-service/">Car service</a></li>
          <li><a href="/sim/">SIM &amp; eSIM</a></li>
        </ul>
      </nav>

      <nav class="footer-col footer-nav" aria-label="Help">
        <div class="footer-nav__title">Need help?</div>
        <ul class="footer-nav__list">
          <li><a href="/faqs/">FAQs</a></li>
          <li><a href="/support/">Customer care</a></li>
          <li><a href="/safety/">Safety tips</a></li>
          <li><a href="/privacy/">Privacy policy</a></li>
          <li><a href="/terms/">Terms of use</a></li>
        </ul>
      </nav>

      <div class="footer-col">
        <div class="footer-nav__title">Connect</div>
        <ul class="footer-social__list">
          <li><a href="https://facebook.com/jahongirtravel" target="_blank" rel="noopener noreferrer">Facebook</a></li>
          <li><a href="https://instagram.com/jahongirtravel" target="_blank" rel="noopener noreferrer">Instagram</a></li>
          <li><a href="https://twitter.com/jahongirtravel" target="_blank" rel="noopener noreferrer">Twitter</a></li>
          <li><a href="https://youtube.com/@jahongirtravel" target="_blank" rel="noopener noreferrer">YouTube</a></li>
          <li><a href="https://pinterest.com/jahongirtravel" target="_blank" rel="noopener noreferrer">Pinterest</a></li>
        </ul>
      </div>
    </div>

    <div class="container footer-bottom">
      <div class="footer-bottom__wrap">
        <div>© 2025 Jahongir Travel. All rights reserved.</div>
        <div class="footer-bottom__legal">
          <a href="/privacy/">Privacy</a>
          <span> • </span>
          <a href="/terms/">Terms</a>
          <span> • </span>
          <a href="/cookies/">Cookies</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- =====================================================
       JAVASCRIPT
       ===================================================== -->
  <!-- Dynamic Tour Slug Detection (MUST run before HTMX) -->
  <script>
    (function() {
      // Get tour slug from URL - supports both /tours/slug and ?slug=...
      let tourSlug = null;

      console.log('[Tour] Current URL:', window.location.href);
      console.log('[Tour] Pathname:', window.location.pathname);
      console.log('[Tour] Search:', window.location.search);

      // Try to get slug from URL path (/tours/slug-name)
      const pathParts = window.location.pathname.split('/').filter(Boolean);
      console.log('[Tour] Path parts:', pathParts);

      if (pathParts[0] === 'tours' && pathParts[1]) {
        tourSlug = pathParts[1];
        console.log('[Tour] ✅ Path-based slug detected:', tourSlug);
      }

      // Fallback to query parameter for backward compatibility
      if (!tourSlug) {
        const urlParams = new URLSearchParams(window.location.search);
        tourSlug = urlParams.get('slug') || urlParams.get('tour');
        if (tourSlug) {
          console.log('[Tour] ✅ Query parameter slug detected:', tourSlug);
        }
      }

      if (tourSlug) {
        // Update all sections with dynamic tour slug
        const sections = document.querySelectorAll('[data-tour-slug]');
        const backendUrl = 'http://127.0.0.1:8000/partials/tours';

        console.log('[Tour] Found', sections.length, 'sections to load');

        sections.forEach(function(section) {
          // Map section class names to partial endpoint names
          const classToPartialMap = {
            'tour-header': 'hero',
            'tour-hero__gallery': 'gallery',
            'tour-overview': 'overview',
            'tour-highlights': 'highlights',
            'tour-includes-excludes': 'included-excluded',
            'tour-meeting': 'meeting-point',
            'tour-cancellation': 'cancellation',
            'tour-itinerary': 'itinerary',
            'tour-faq': 'faqs',
            'tour-extras': 'extras',
            'tour-reviews': 'reviews',
            'tour-know-before': 'requirements'
          };

          // Get the first class name from the element
          const className = section.className.split(' ')[0];
          const partialName = classToPartialMap[className];

          if (partialName) {
            const dynamicUrl = backendUrl + '/' + tourSlug + '/' + partialName;
            section.setAttribute('hx-get', dynamicUrl);
            section.setAttribute('hx-trigger', 'load once');
            section.setAttribute('hx-swap', 'innerHTML');
            section.setAttribute('data-tour-slug', tourSlug);
            console.log('[Tour] Updated ' + className + ' → ' + dynamicUrl);
          } else {
            console.warn('[Tour] Unknown section class:', className);
          }
        });

        // Trigger HTMX loading after attributes are set
        // Store sections to load after HTMX is ready
        window.tourSectionsToLoad = sections;

        // Wait for HTMX to be ready
        document.addEventListener('DOMContentLoaded', function() {
          console.log('[Tour] DOMContentLoaded fired');
          // Give HTMX a moment to initialize
          setTimeout(function() {
            console.log('[Tour] Checking for HTMX...');
            if (!window.htmx) {
              console.error('[Tour] ❌ HTMX not loaded!');
              return;
            }
            if (!window.tourSectionsToLoad) {
              console.error('[Tour] ❌ No sections to load!');
              return;
            }

            console.log('[Tour] ✅ Starting to load content for', window.tourSectionsToLoad.length, 'sections');
            window.tourSectionsToLoad.forEach(function(section) {
              const url = section.getAttribute('hx-get');
              if (url) {
                console.log('[Tour] 📡 Loading:', url);
                htmx.ajax('GET', url, {
                  target: section,
                  swap: 'innerHTML'
                });
              } else {
                console.warn('[Tour] ⚠️ Section has no hx-get URL:', section.className);
              }
            });
          }, 100);
        });
      } else {
        console.error('[Tour] ❌ No tour slug found in URL path or query parameter!');
        console.error('[Tour] Expected URL format: /tours/slug-name or ?slug=slug-name');
      }
    })();
  </script>

  <!-- HTMX Library -->
  <script src="/js/htmx.min.js"></script>

  <!-- HTMX Debug Script -->
  <script>
    console.log('[HTMX] Page loaded - tour-details.html');
    console.log('[HTMX] Backend URL: http://127.0.0.1:8000');

    // HTMX event listeners for debugging and error handling
    document.body.addEventListener('htmx:beforeRequest', function(evt) {
      console.log('[HTMX] Loading:', evt.detail.pathInfo.requestPath);
    });

    document.body.addEventListener('htmx:afterSwap', function(evt) {
      console.log('[HTMX] Loaded successfully:', evt.detail.pathInfo.requestPath);
    });

    document.body.addEventListener('htmx:responseError', function(evt) {
      console.error('[HTMX] Error:', evt.detail.pathInfo.requestPath, 'Status:', evt.detail.xhr.status);
      evt.detail.target.innerHTML = '<div style="padding:20px;background:#fee;border:1px solid #c33;color:#c33;">Failed to load content. Please refresh the page.</div>';
    });

    document.body.addEventListener('htmx:sendError', function(evt) {
      console.error('[HTMX] Network error:', evt.detail);
    });
  </script>

  <!-- Tour Details JavaScript -->
  <script src="/tour-details.js" defer></script>
  <script src="/js/gallery-lightbox.js" defer></script>
  <script src="/js/tour-reviews.js" defer></script>

  <!-- Main JavaScript -->
  <script src="/js/main.js" defer></script>

  <!-- Booking Confirmation Modal -->
  <div id="booking-confirmation-modal" class="modal-overlay" style="display: none;">
    <div class="modal-container">
      <div class="modal-header">
        <div class="success-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
        </div>
        <h2 class="modal-title">Booking Request Submitted!</h2>
        <p class="modal-subtitle">We've received your request and will get back to you soon</p>
        <button class="modal-close" aria-label="Close">&times;</button>
      </div>

      <div class="modal-body">
        <!-- Booking Reference -->
        <div class="confirmation-reference">
          <span class="label">Your Reference Number</span>
          <span class="reference-number" id="modal-reference">BK-2025-XXX</span>
          <p class="reference-note">Save this number for your records</p>
        </div>

        <!-- Booking Summary -->
        <div class="booking-summary">
          <h3 class="section-title">Booking Summary</h3>
          <div class="summary-grid">
            <div class="summary-item">
              <span class="label">Tour</span>
              <span class="value" id="modal-tour-name">...</span>
            </div>
            <div class="summary-item">
              <span class="label">Date</span>
              <span class="value" id="modal-date">...</span>
            </div>
            <div class="summary-item">
              <span class="label">Guests</span>
              <span class="value" id="modal-guests">...</span>
            </div>
            <div class="summary-item summary-item--total">
              <span class="label">Estimated Total</span>
              <span class="value highlight" id="modal-total">$200.00</span>
            </div>
          </div>
        </div>

        <!-- Customer Info -->
        <div class="customer-info">
          <h3 class="section-title">Confirmation Email Sent To</h3>
          <p class="email-address" id="modal-customer-email">customer@example.com</p>
        </div>

        <!-- Next Steps -->
        <div class="next-steps">
          <h3 class="section-title">What Happens Next?</h3>
          <ol class="steps-list">
            <li>We'll check availability for your requested dates</li>
            <li>You'll receive confirmation within <strong>24 hours</strong></li>
            <li>Check your email (<strong id="modal-customer-email-inline">...</strong>) for details</li>
            <li>No payment required until we confirm availability</li>
          </ol>
        </div>

        <!-- Important Note -->
        <div class="important-note">
          <svg class="warning-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
            <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/>
          </svg>
          <p><strong>Please check your spam folder</strong> if you don't receive our email within an hour.</p>
        </div>
      </div>

      <div class="modal-footer">
        <a href="#" id="view-full-confirmation" class="btn btn--primary btn--large">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
          View Full Confirmation
        </a>
        <button class="btn btn--secondary btn--large" id="continue-browsing">
          Continue Browsing Tours
        </button>
      </div>
    </div>
  </div>

</body>
</html>
  
  <!-- Dynamic Title Update -->
  <script>
    // Update document title when tour hero loads
    document.addEventListener('DOMContentLoaded', function() {
      // Wait for HTMX to load the hero section
      document.body.addEventListener('htmx:afterSettle', function(event) {
        if (event.detail.target.classList.contains('tour-header')) {
          const tourTitle = document.querySelector('.tour-title');
          if (tourTitle && tourTitle.textContent) {
            document.title = tourTitle.textContent.trim() + ' | Jahongir Travel';
          }
        }
      });
    });
  </script>

  <!-- Booking Action Buttons Handler -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const bookingBtn = document.querySelector('[data-action="booking"]');
      const inquiryBtn = document.querySelector('[data-action="inquiry"]');
      const bookingForm = document.getElementById('booking-form');
      const step2Form = document.getElementById('step-2-full-form');
      const actionTypeField = document.getElementById('action-type');
      const messageSection = document.getElementById('message-section');
      const messageField = document.getElementById('inquiry-message');
      const submitText = document.getElementById('submit-text');
      const tourDateField = document.getElementById('tour-date');
      const tourGuestsField = document.getElementById('tour-guests');
      const tourIdField = document.getElementById('tour-id');
      const csrfTokenField = document.getElementById('csrf-token');

      // Fetch CSRF token and populate field
      fetch('http://127.0.0.1:8000/csrf-token')
        .then(response => response.json())
        .then(data => {
          if (data.token && csrfTokenField) {
            csrfTokenField.value = data.token;
            console.log('[Booking] CSRF token loaded');
          }
        })
        .catch(error => console.error('[Booking] Error loading CSRF token:', error));

      // Extract tour slug from URL and fetch tour ID
      const pathParts = window.location.pathname.split('/').filter(Boolean);
      if (pathParts[0] === 'tours' && pathParts[1]) {
        const tourSlug = pathParts[1];
        console.log('[Booking] Tour slug:', tourSlug);

        // Fetch tour ID from backend
        fetch('http://127.0.0.1:8000/api/tours/' + tourSlug)
          .then(response => response.json())
          .then(data => {
            if (data.id && tourIdField) {
              tourIdField.value = data.id;
              console.log('[Booking] Tour ID set:', data.id);
            }
          })
          .catch(error => console.error('[Booking] Error fetching tour ID:', error));
      }

      // Handle booking button click
      if (bookingBtn) {
        bookingBtn.addEventListener('click', function() {
          // Set action type
          if (actionTypeField) actionTypeField.value = 'booking';

          // Update button states
          bookingBtn.classList.add('active');
          inquiryBtn.classList.remove('active');

          // Make date & guests required for booking
          if (tourDateField) tourDateField.required = true;
          if (tourGuestsField) tourGuestsField.required = true;

          // Hide message section (optional for booking)
          if (messageSection) messageSection.style.display = 'none';
          if (messageField) messageField.required = false;

          // Update submit button text
          if (submitText) submitText.textContent = 'Send Booking Request';

          // Show step 2 form
          if (step2Form) {
            step2Form.style.display = 'block';
            // Scroll to form
            step2Form.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            // Focus first input
            const firstInput = step2Form.querySelector('input[type="text"], input[type="email"]');
            if (firstInput) setTimeout(() => firstInput.focus(), 300);
          }

          console.log('[Booking] Action: booking');
        });
      }

      // Handle inquiry button click
      if (inquiryBtn) {
        inquiryBtn.addEventListener('click', function() {
          // Set action type
          if (actionTypeField) actionTypeField.value = 'inquiry';

          // Update button states
          inquiryBtn.classList.add('active');
          bookingBtn.classList.remove('active');

          // Make date & guests optional for inquiry
          if (tourDateField) tourDateField.required = false;
          if (tourGuestsField) tourGuestsField.required = false;

          // Show message section (required for inquiry)
          if (messageSection) messageSection.style.display = 'block';
          if (messageField) messageField.required = true;

          // Update submit button text
          if (submitText) submitText.textContent = 'Send Inquiry';

          // Show step 2 form
          if (step2Form) {
            step2Form.style.display = 'block';
            // Scroll to form
            step2Form.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            // Focus first input
            const firstInput = step2Form.querySelector('input[type="text"], input[type="email"]');
            if (firstInput) setTimeout(() => firstInput.focus(), 300);
          }

          console.log('[Booking] Action: inquiry');
        });
      }

      // Handle form submission
      if (bookingForm) {
        bookingForm.addEventListener('submit', function(e) {
          e.preventDefault();

          const submitButton = document.getElementById('submit-button');
          const formData = new FormData(bookingForm);

          // Disable submit button
          if (submitButton) {
            submitButton.disabled = true;
            submitButton.classList.add('loading');
          }

          // Send AJAX request
          fetch(bookingForm.action, {
            method: 'POST',
            headers: {
              'Accept': 'application/json',
              'X-Requested-With': 'XMLHttpRequest'
            },
            body: formData
          })
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              // Get booking/inquiry data
              const record = data.booking || data.inquiry;
              const isBooking = !!data.booking;

              // Populate modal with data
              document.getElementById('modal-reference').textContent = record.reference || 'N/A';
              document.getElementById('modal-tour-name').textContent = record.tour?.title || tourIdField?.options[tourIdField.selectedIndex]?.text || 'Your Selected Tour';
              document.getElementById('modal-date').textContent = record.start_date ? new Date(record.start_date).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' }) : 'Date TBD';
              document.getElementById('modal-guests').textContent = (record.pax_total || formData.get('number_of_guests') || '1') + ' guest(s)';
              document.getElementById('modal-total').textContent = record.total_price ? '$' + parseFloat(record.total_price).toFixed(2) : 'TBD';
              document.getElementById('modal-customer-email').textContent = record.customer?.email || formData.get('customer_email') || 'your email';
              document.getElementById('modal-customer-email-inline').textContent = record.customer?.email || formData.get('customer_email') || 'your email';

              // Set confirmation page link (will create this route later)
              document.getElementById('view-full-confirmation').href = `/booking/confirmation/${record.reference}`;

              // Update modal title for inquiry
              if (!isBooking) {
                document.querySelector('.modal-title').textContent = 'Inquiry Submitted!';
                document.querySelector('.modal-subtitle').textContent = 'We\'ve received your question and will respond soon';
                document.querySelector('.summary-item--total').style.display = 'none';
              }

              // Show modal
              document.getElementById('booking-confirmation-modal').style.display = 'flex';

              // Reset form
              bookingForm.reset();
              step2Form.style.display = 'none';
              bookingBtn.classList.remove('active');
              inquiryBtn.classList.remove('active');

              console.log('[Booking] Confirmation modal shown for:', record.reference);
            } else {
              // Show error message with validation errors if available
              let errorMessage = data.message || 'Please check your form and try again.';

              if (data.errors) {
                errorMessage += '\n\nValidation errors:\n';
                Object.keys(data.errors).forEach(field => {
                  errorMessage += '- ' + field + ': ' + data.errors[field].join(', ') + '\n';
                });
              }

              alert('Error: ' + errorMessage);
              console.error('[Booking] Validation errors:', data.errors);
            }
          })
          .catch(error => {
            console.error('[Booking] Submission error:', error);
            alert('An error occurred. Please try again.');
          })
          .finally(() => {
            // Re-enable submit button
            if (submitButton) {
              submitButton.disabled = false;
              submitButton.classList.remove('loading');
            }
          });
        });
      }

      // Update form field names to match backend expectations
      if (tourDateField) tourDateField.name = 'start_date';
      if (tourGuestsField) tourGuestsField.name = 'number_of_guests';

      console.log('[Booking] Action buttons initialized');
    });

    // ================================================================
    // BOOKING CONFIRMATION MODAL - CLOSE HANDLERS
    // ================================================================
    document.addEventListener('DOMContentLoaded', function() {
      const modal = document.getElementById('booking-confirmation-modal');
      const closeBtn = document.querySelector('.modal-close');
      const continueBrowsingBtn = document.getElementById('continue-browsing');

      // Close modal function
      function closeModal() {
        if (modal) {
          modal.style.display = 'none';
          console.log('[Modal] Confirmation modal closed');
        }
      }

      // Close on X button click
      if (closeBtn) {
        closeBtn.addEventListener('click', closeModal);
      }

      // Close on "Continue Browsing" button
      if (continueBrowsingBtn) {
        continueBrowsingBtn.addEventListener('click', closeModal);
      }

      // Close on overlay click (clicking outside modal)
      if (modal) {
        modal.addEventListener('click', function(e) {
          if (e.target === modal) {
            closeModal();
          }
        });
      }

      // Close on ESC key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modal && modal.style.display === 'flex') {
          closeModal();
        }
      });

      console.log('[Modal] Close handlers initialized');
    });
  </script>
